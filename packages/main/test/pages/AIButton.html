<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta charset="utf-8">
	<title>AI Button</title>
	<script src="%VITE_BUNDLE_PATH%" type="module"></script>
	<link rel="stylesheet" type="text/css" href="./styles/Button.css">

</head>

<body class="button1auto">

	<ui5-title>AiButton as Component</ui5-title>

	<ui5-ai-button id="myAiButton1" icon="ai" state="Generate">
		<ui5-menu id="myAiButton1Menu" slot="menu">
			<ui5-menu-item text="Regenerate"></ui5-menu-item>
			<ui5-menu-item text="Fix Spelling & Grammar" starts-section></ui5-menu-item>
			<ui5-menu-item text="Change Tone">
				<ui5-menu-item text="Option 1"></ui5-menu-item>
				<ui5-menu-item text="Option 2"></ui5-menu-item>
				<ui5-menu-item text="Option 3"></ui5-menu-item>
			</ui5-menu-item>
			<ui5-menu-item text="Text Length">
				<ui5-menu-item text="Short"></ui5-menu-item>
				<ui5-menu-item text="Medium"></ui5-menu-item>
				<ui5-menu-item text="Long"></ui5-menu-item>
			</ui5-menu-item>
			<ui5-menu-item text="Bulleted List"></ui5-menu-item>
			<ui5-menu-item text="Translate">
				<ui5-menu-item text="English"></ui5-menu-item>
				<ui5-menu-item text="German"></ui5-menu-item>
				<ui5-menu-item text="Spanish"></ui5-menu-item>
			</ui5-menu-item>
		</ui5-menu>
	</ui5-ai-button>

	<script>

		/* AiButton as component */

		// timeout ID (not needed in real scenario)
		let aiGeneratingTimeout1;

		/**
		 * Do generation handling here
		 */
		 myAiButton1.addEventListener("state-change", function(evt) {
			const state = evt.detail.state;

			if (state === "Generating") {
				aiGeneratingTimeout1 = setTimeout(function() {
					myAiButton1.state = "Revise";
				}, 2000);
			} else {
				clearTimeout(aiGeneratingTimeout1);
				myAiButton1.state = "Generate";
			}
		});

		/**
		 * Here is the logic what happens when specific menu item is clicked
		 */
		 myAiButton1Menu.addEventListener("item-click", function(evt) {
			if (evt.detail.text === "Regenerate") {
				myAiButton1.state = "Generating";
			}
		});

	</script>


	<br><br>
	<ui5-title>AiButton as Sample (using Button)</ui5-title>

	<style>
		.ui5-ai-button-content {
			display: flex;
			align-items: center;
		}

		.ui5-ai-button-content > [ui5-icon] {
			margin-inline-start: 0.25rem;
			color: var(--sapButton_TextColor);
		}

		.ui5-ai-button-content > [ui5-icon][name=""] {
			display: none;
		}
	</style>

	<ui5-button id="aiButton" class="ai-button" icon="ai" state="generate"><div class="ui5-ai-button-content"><span>Generate</span><ui5-icon name=""></ui5-icon></div></ui5-button>

	<ui5-menu id="menu">
		<ui5-menu-item text="Regenerate"></ui5-menu-item>
		<ui5-menu-item text="Fix Spelling & Grammar" starts-section></ui5-menu-item>
		<ui5-menu-item text="Change Tone">
			<ui5-menu-item text="Option 1"></ui5-menu-item>
			<ui5-menu-item text="Option 2"></ui5-menu-item>
			<ui5-menu-item text="Option 3"></ui5-menu-item>
		</ui5-menu-item>
		<ui5-menu-item text="Text Length">
			<ui5-menu-item text="Short"></ui5-menu-item>
			<ui5-menu-item text="Medium"></ui5-menu-item>
			<ui5-menu-item text="Long"></ui5-menu-item>
		</ui5-menu-item>
		<ui5-menu-item text="Bulleted List"></ui5-menu-item>
		<ui5-menu-item text="Translate">
			<ui5-menu-item text="English"></ui5-menu-item>
			<ui5-menu-item text="German"></ui5-menu-item>
			<ui5-menu-item text="Spanish"></ui5-menu-item>
		</ui5-menu-item>
	</ui5-menu>

	<script>

		/* AiButton as sample */

		// timeout ID (not needed in real scenario)
		let generatingTimeout;

		/**
		 * AI Button state switcher
		 */
		function changeButtonState(button, state) {
			const aiButtonStates = {
				generate: {
					icon: "ai",
					text: "Generate",
				},
				generating: {
					icon: "stop",
					text: "Stop Generating",
				},
				revise: {
					icon: "ai",
					text: "Revise",
				},
			};

			if (state === "generate") {
				clearTimeout(generatingTimeout);
			} else if (state === "generating") {
				generatingTimeout = setTimeout(function() {
					if (aiButton.getAttribute("state") === "generating") {
						changeButtonState(aiButton, "revise");
					}
				}, 2000);
			}

			if (aiButtonStates[state]) {
				button.icon = aiButtonStates[state].icon;
				button.childNodes[0].childNodes[0].textContent = aiButtonStates[state].text;
				button.childNodes[0].childNodes[1].name = state === "revise" ? "navigation-down-arrow" : "";
				button.setAttribute("state", state);
			}
		}

		aiButton.addEventListener("click", function() {
			switch (aiButton.getAttribute("state")) {
				case "generate":
					changeButtonState(aiButton, "generating");
					break;
				case "generating":
					changeButtonState(aiButton, "generate");
					break;
				case "revise":
					if (menu.open) {
						menu.close();
					} else {
						menu.showAt(aiButton);
					}
					break;
			}
		});

		/**
		 * Here is the logic what happens when specific menu item is clicked
		 */
		menu.addEventListener("item-click", function(evt) {
			if (evt.detail.text === "Regenerate") {
				changeButtonState(aiButton, "generating");
			}
		});

	</script>

</body>
</html>
